<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>2Q2R Demo</title>
    <link rel="stylesheet" type="text/css" href="styles.css">
</head>

<body style="margin: 200px">
    <script type="text/javascript" src="lib/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="lib/jquery-qrcode/dist/jquery-qrcode.min.js"></script>
    <script type="text/javascript">

        function getRegistrationData (email) {
            $.get("/challenge?userID=" + email, function (res) {
                console.log(res);
                if (res.error) {
                    alert(res.error);
                } else {
                    $("#qrcode").empty();
                    $("#qrcode").qrcode({
                      text: "R " + res.challenge + " " + res.infoURL,
                      size: $("#qrcode").width(),
                      radius: 0.3
                    });
                }
            }, "json");
        }

        function displayKeys (keys) {
                var form = $("#key-list");

                for (var keyHandle in keys) {
                    input += "<input name=\"key\" type=\"radio\">" + keys[keyHandle] + "</input>";
                }
        }

        function getKeys (email) {
            $.get("/keys/" + email, function (data) {
                if (data.error) {
                    alert(error);
                } else {
                    displayKeys(data);
                }
            }, "json");
        }

        function getAuthenticationData (email, keyHandle) {
            $.get("/challenge?userID=" + email + "&keyHandle=" + keyHandle, function(res) {
                console.log(res);
                if (res.error) {
                    alert(res.error);
                } else {
                    $("#qrcode").empty();
                    $("#qrcode").qrcode({
                        text: "A " + res.appID + " " + res.challenge + " " + res.keyID,
                        size: $("#qrcode").width,
                        radius: 0.3
                    });
                }
            }, "json");
        }

        $(document).ready(function () {
           $("#button-register").on("click", function () {
                getRegistrationData($("#user-email").val());
            });
           $("#button-authenticate").on("click", function () {
                //getKeys($("#user-email").val());
            });
        });

    </script>

    <h1> 2Q2R Demo </h1>
    <div id="qrcode"></div>
    <input id="user-email" type="text" value="alidobra@gmail.com"/><br/>
    <div id="button-group">
        <button id="button-register">Register</button>
        <button id="button-authenticate" data-toggle="modal" data-target="#key-selection-modal">Authenticate</button>
    </div>
    <form id="key-list"/>

</body>

</html>